<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OVA: Daily Routine Vocabulary</title>
  <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-slate-50">

<div class="flex min-h-screen">
  <!-- Sidebar -->
  <aside class="w-64 bg-white shadow-lg flex-shrink-0 hidden md:flex md:flex-col sticky-sidebar">
    <div class="p-4">
      <div style="width: 150px; height: 150px;" class="p-2 mx-auto flex items-center justify-center bg-white rounded-full shadow-lg border-2 border-green-500 transition-shadow duration-300 hover:shadow-green-400">
          <img src="img/logo.webp" alt="Logo OVA" class="w-5/6 h-5/6 object-contain" loading="lazy">
      </div>
  </div>
    <nav class="mt-6 flex-1">
      <a href="#" class="sidebar-link active flex items-center py-3 px-6 font-medium text-slate-700" data-target="introduccion"><span class="mr-3 text-xl">🚀</span> Introducción</a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="objetivos"><span class="mr-3 text-xl">🎯</span> Objetivos</a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="contenido"><span class="mr-3 text-xl">📚</span> Contenido</a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="actividades"><span class="mr-3 text-xl">✍️</span> Actividades</a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="evaluacion"><span class="mr-3 text-xl">✔️</span> Evaluación</a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="recursos"><span class="mr-3 text-xl">📖</span> Recursos</a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="bibliografia"><span class="mr-3 text-xl">📚</span> Bibliografía</a>
    </nav>
  </aside>

        <!-- Main Content -->
  <main class="flex-1 p-4 sm:p-6 md:p-10 bg-gray-50">
      <!-- Mobile header -->
      <div class="md:hidden mb-6 flex flex-col items-center">
        <div style="width: 100px; height: 100px;" class="p-2 flex items-center justify-center bg-white rounded-full shadow-lg transition-shadow duration-300 hover:shadow-green-400 mb-2">
          <img src="img/logo.webp" alt="Logo OVA" class="w-5/6 h-5/6 object-contain" loading="lazy">
        </div>
        <select id="mobile-nav" class="w-full mt-2 p-2 border rounded-md bg-white shadow-sm">
          <option value="introduccion">🚀 Introducción</option>
          <option value="objetivos">🎯 Objetivos</option>
          <option value="contenido">📚 Contenido</option>
          <option value="actividades">✍️ Actividades</option>
          <option value="evaluacion">✔️ Evaluación</option>
          <option value="recursos">📖 Recursos</option>
          <option value="bibliografia">📚 Bibliografía</option>
        </select>
      </div>

    <!-- Introducción -->
    <section id="introduccion" class="content-pane active">
      <h2 class="text-2xl sm:text-3xl font-bold text-green-800 mb-4">Daily activities vocabulary</h2>
      </p>
      <p class="text-slate-700 leading-relaxed mb-4">
        💻 Y lo más especial es que tu rutina no se queda solo en el colegio. Los sábados también vives una experiencia distinta: tu acercamiento al mundo de la tecnología. Ese día en particular, en lugar de seguir la rutina común, enciendes el computador 🖥, lees instrucciones en inglés 📖, practicas ejercicios de programación 👩‍💻👨‍💻 y aprendes a organizar pequeños proyectos como si fueran pasos de un algoritmo. Así, mientras aprendes a describir tu rutina diaria en inglés, también descubrirás el vocabulario que te servirá para hablar de lo que haces como estudiante de programación. Este módulo te invita a conectar lo cotidiano con lo tecnológico, mostrándote que cada acción de tu día puede convertirse en una frase en inglés que abre puertas a nuevas oportunidades.
      </p>
      <div class="bg-gradient-to-r from-green-50 to-blue-50 border-l-4 border-green-500 rounded-r-lg p-4 mb-4">
        <p class="text-green-800 font-semibold mb-2">🎯 ¿Qué aprenderás en este módulo?</p>
        <ul class="text-green-800 text-sm space-y-1">
          <li>• Vocabulario esencial para describir tu rutina diaria en inglés</li>
          <li>• Términos técnicos que usarás en programación y tecnología</li>
          <li>• Cómo conectar actividades cotidianas con el mundo digital</li>
          <li>• Expresiones útiles para presentarte y hablar de tus hábitos</li>
        </ul>
      </div>
      <div class="bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg p-4">
        <p class="text-yellow-800 text-sm">
          <strong>💡 Consejo:</strong> Este vocabulario te servirá no solo para hablar de tu rutina, sino también para comunicarte en el mundo de la tecnología, donde el inglés es el idioma universal. ¡Cada palabra que aprendas aquí te acercará más a tus metas profesionales!
        </p>
      </div>
                <!-- Componente de síntesis de voz para introducción -->
                <div class="speech-controls mb-4 p-3 bg-green-100 rounded-lg flex items-center flex-wrap gap-2 mt-4" data-target="introduccion">
                    <button class="play-btn bg-green-600 hover:bg-green-700 text-white font-medium py-1 px-4 rounded-full flex items-center">
                        <span class="mr-1">▶️</span> Leer
                    </button>
                    <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-4 rounded-full flex items-center" disabled>
                        <span class="mr-1">⏸️</span> Pausar
                    </button>
                    <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-4 rounded-full flex items-center" disabled>
                        <span class="mr-1">⏹️</span> Detener
                    </button>
                    <div class="flex items-center ml-2">
                        <label for="speech-rate-introduccion" class="text-sm text-green-800 mr-2">Velocidad:</label>
                        <input type="range" class="speech-rate" id="speech-rate-introduccion" min="0.5" max="2" step="0.1" value="1" class="w-24">
                    </div>
                </div>
    </section>

    <!-- Objetivos -->
    <section id="objetivos" class="content-pane">
      <h2 class="text-2xl sm:text-3xl font-bold text-green-800 mb-6">Learning Goals</h2>
      <ul class="space-y-4">
        <li class="flex items-start p-4 bg-white rounded-lg shadow-sm">
          <span class="text-green-700 mr-3 text-2xl">1.</span>
          <span>Identificar palabras y expresiones en inglés relacionadas con las rutinas diarias de un estudiante (wake up, have breakfast, go to school, do homework).</span>
        </li>
        <li class="flex items-start p-4 bg-white rounded-lg shadow-sm">
          <span class="text-green-700 mr-3 text-2xl">2.</span>
          <span>Reconocer vocabulario básico de tecnología y programación que forma parte de la rutina de los sábados (turn on the computer, check emails, program, create projects).</span>
        </li>
        <li class="flex items-start p-4 bg-white rounded-lg shadow-sm">
          <span class="text-green-700 mr-3 text-2xl">3.</span>
          <span>Asociar imágenes, acciones y situaciones cotidianas con su correspondiente vocabulario en inglés.</span>
        </li>
        <li class="flex items-start p-4 bg-white rounded-lg shadow-sm">
          <span class="text-green-700 mr-3 text-2xl">4.</span>
          <span>Practicar la pronunciación y el uso de este vocabulario en actividades orales y escritas sencillas.</span>
        </li>
        <li class="flex items-start p-4 bg-white rounded-lg shadow-sm">
          <span class="text-green-700 mr-3 text-2xl">5.</span>
          <span>Aplicar el vocabulario aprendido para describir de manera simple la rutina diaria y las actividades tecnológicas en inglés.</span>
        </li>
      </ul>
                <!-- Componente de síntesis de voz para objetivos -->
                <div class="speech-controls mb-4 p-3 bg-green-100 rounded-lg flex items-center flex-wrap gap-2 mt-4" data-target="objetivos">
                    <button class="play-btn bg-green-600 hover:bg-green-700 text-white font-medium py-1 px-4 rounded-full flex items-center">
                        <span class="mr-1">▶️</span> Leer
                    </button>
                    <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-4 rounded-full flex items-center" disabled>
                        <span class="mr-1">⏸️</span> Pausar
                    </button>
                    <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-4 rounded-full flex items-center" disabled>
                        <span class="mr-1">⏹️</span> Detener
                    </button>
                    <div class="flex items-center ml-2">
                        <label for="speech-rate-objetivos" class="text-sm text-green-800 mr-2">Velocidad:</label>
                        <input type="range" class="speech-rate" id="speech-rate-objetivos" min="0.5" max="2" step="0.1" value="1" class="w-24">
                    </div>
                </div>
    </section>

    <!-- Contenido -->
    <section id="contenido" class="content-pane">
                <h2 class="text-2xl sm:text-3xl font-bold text-green-800 mb-6">Content</h2>

                <!-- Key Vocabulary -->
      <div class="mb-6">
                    <h3 class="text-xl font-bold text-green-700 mb-2">Key Vocabulary</h3>
                    <p class="text-slate-600 mb-4">Tap to listen 🔊</p>
                    
                    <!-- Imagen de rutina diaria -->
                    <div class="mb-6 text-center">
                        <img src="img/My daily routine.jpeg" alt="My Daily Routine - Mi Rutina Diaria" 
                             class="mx-auto rounded-lg shadow-lg max-w-full h-auto cursor-pointer hover:opacity-90 transition-opacity duration-200" 
                             style="max-height: 400px; width: auto;"
                             onclick="openImageModal(this.src, this.alt)">
                        <p class="text-sm text-slate-500 mt-2 italic">Haz clic en la imagen para ampliarla</p>
                    </div>
                    
        <!-- Vocabulario por categorías -->
        <div class="space-y-6">
          <!-- Rutina Matutina -->
          <div class="bg-orange-50 border-l-4 border-orange-500 rounded-r-lg p-4">
            <h4 class="text-orange-800 font-semibold mb-3 flex items-center">
              <span class="mr-2">🌅</span> Rutina Matutina - Morning Routine
            </h4>
            <div id="morning-vocab" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"></div>
          </div>

          <!-- Actividades Escolares -->
          <div class="bg-blue-50 border-l-4 border-blue-500 rounded-r-lg p-4">
            <h4 class="text-blue-800 font-semibold mb-3 flex items-center">
              <span class="mr-2">🏫</span> Actividades Escolares - School Activities
            </h4>
            <div id="school-vocab" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"></div>
          </div>

          <!-- Comidas y Descansos -->
          <div class="bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg p-4">
            <h4 class="text-yellow-800 font-semibold mb-3 flex items-center">
              <span class="mr-2">🍽️</span> Comidas Y Descansos - Meals & Breaks
            </h4>
            <div id="meals-vocab" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"></div>
          </div>

          <!-- Actividades Sociales -->
          <div class="bg-purple-50 border-l-4 border-purple-500 rounded-r-lg p-4">
            <h4 class="text-purple-800 font-semibold mb-3 flex items-center">
              <span class="mr-2">👥</span> Actividades Sociales - Social Activities
            </h4>
            <div id="social-vocab" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"></div>
          </div>

          <!-- Entretenimiento -->
          <div class="bg-pink-50 border-l-4 border-pink-500 rounded-r-lg p-4">
            <h4 class="text-pink-800 font-semibold mb-3 flex items-center">
              <span class="mr-2">🎮</span> Entretenimiento - Entertainment
            </h4>
            <div id="entertainment-vocab" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"></div>
          </div>

          <!-- Rutina Nocturna -->
          <div class="bg-indigo-50 border-l-4 border-indigo-500 rounded-r-lg p-4">
            <h4 class="text-indigo-800 font-semibold mb-3 flex items-center">
              <span class="mr-2">🌙</span> Rutina Nocturna - Evening Routine
            </h4>
            <div id="evening-vocab" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"></div>
          </div>

          <!-- Tecnología y Programación -->
          <div class="bg-green-50 border-l-4 border-green-500 rounded-r-lg p-4">
            <h4 class="text-green-800 font-semibold mb-3 flex items-center">
              <span class="mr-2">💻</span> Tecnología Y Programación - Technology & Programming
            </h4>
            <div id="tech-vocab" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"></div>
          </div>
        </div>
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg p-4">
                        <p class="text-yellow-800 text-sm">
                            <strong>✨ Note:</strong> Este vocabulario es tu caja de herramientas en inglés. Con estas palabras podrás:
                        </p>
                        <ul class="text-yellow-800 text-sm mt-2 ml-4">
                            <li>• Contar cómo es un día normal en tu colegio.</li>
                            <li>• Explicar qué haces los sábados cuando estudias programación.</li>
                            <li>• Empezar a describir tus hábitos como si fueran pasos de un algoritmo: primero me levanto, luego desayuno, después programo, finalmente descanso.</li>
                        </ul>
                    </div>
      </div>

    </section>

    <!-- Actividades -->
    <section id="actividades" class="content-pane">
                <h2 class="text-2xl sm:text-3xl font-bold text-green-800 mb-6">Activities</h2>

      <!-- Drag & Drop Matching -->
      <div class="bg-white border-l-4 border-green-500 rounded-lg shadow-sm p-6 mb-6">
        <h3 class="text-xl font-bold text-green-700 mb-2">1) Empareja: Inglés ↔ Español</h3>
        <p class="text-slate-600 mb-4">Arrastra cada expresión en inglés hacia su traducción correcta.</p>
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <h4 class="font-semibold mb-2">Palabras (Arrastra)</h4>
            <div id="drag-bank" class="grid grid-cols-2 gap-2"></div>
          </div>
          <div>
            <h4 class="font-semibold mb-2">Traducciones (Suelta Aquí)</h4>
            <div id="drop-bank" class="grid grid-cols-1 sm:grid-cols-2 gap-2"></div>
          </div>
        </div>
        <button id="check-matching" class="mt-4 bg-green-600 text-white font-semibold py-2 px-4 rounded hover:bg-green-700">Verificar</button>
        <div id="matching-result" class="mt-3 font-medium"></div>
      </div>

      <!-- Cloze (fill in blanks) -->
      <div class="bg-white border-l-4 border-green-500 rounded-lg shadow-sm p-6 mb-6">
        <h3 class="text-xl font-bold text-green-700 mb-2">2) Completa Las Frases</h3>
        <p class="text-slate-600 mb-3">Usa estas palabras: <span class="tag inline-block px-2 py-1 rounded bg-green-50 text-green-700">wake up</span> <span class="tag inline-block px-2 py-1 rounded bg-green-50 text-green-700">have breakfast</span> <span class="tag inline-block px-2 py-1 rounded bg-green-50 text-green-700">go to school</span> <span class="tag inline-block px-2 py-1 rounded bg-green-50 text-green-700">do homework</span> <span class="tag inline-block px-2 py-1 rounded bg-green-50 text-green-700">check email</span> <span class="tag inline-block px-2 py-1 rounded bg-green-50 text-green-700">study programming</span> <span class="tag inline-block px-2 py-1 rounded bg-green-50 text-green-700">use the computer</span> <span class="tag inline-block px-2 py-1 rounded bg-green-50 text-green-700">go to bed</span></p>
        <div id="cloze-list" class="space-y-3"></div>
        <button id="check-cloze" class="mt-4 bg-green-600 text-white font-semibold py-2 px-4 rounded hover:bg-green-700">Comprobar</button>
        <div id="cloze-result" class="mt-3 font-medium"></div>
      </div>

      <!-- Ordering tokens -->
      <div class="bg-white border-l-4 border-green-500 rounded-lg shadow-sm p-6 mb-6">
        <h3 class="text-xl font-bold text-green-700 mb-2">3) Ordena Las Oraciones</h3>
        <p class="text-slate-600 mb-3">Las palabras están desordenadas. Tu tarea es colocarlas en el orden correcto para formar oraciones con sentido en inglés.</p>
        <div id="order-list" class="space-y-4"></div>
        <button id="check-order" class="mt-4 bg-green-600 text-white font-semibold py-2 px-4 rounded hover:bg-green-700">Comprobar</button>
        <div id="order-result" class="mt-3 font-medium"></div>
      </div>

      <!-- Speaking / Recording -->
      <div class="bg-white border-l-4 border-green-500 rounded-lg shadow-sm p-6">
        <h3 class="text-xl font-bold text-green-700 mb-2">4) Speaking: Graba Tu Rutina</h3>
        <p class="text-slate-600 mb-3">Graba un audio (30–60 s) diciendo al menos 5 actividades. Ejemplo: <i>I wake up at 6, I have breakfast, I go to class, I study programming and I check my email at night.</i></p>
        
        <!-- Controles de grabación -->
        <div class="flex items-center gap-3 mb-4">
          <button id="rec-start" class="bg-green-600 text-white font-semibold py-2 px-4 rounded hover:bg-green-700 transition-colors">
            🎙️ Iniciar
          </button>
          <button id="rec-stop" class="bg-red-600 text-white font-semibold py-2 px-4 rounded hover:bg-red-700 transition-colors" disabled>
            ⏹️ Detener
          </button>
        </div>
        
        <!-- Estado y temporizador -->
        <div class="flex items-center gap-4 mb-4">
          <span id="rec-status" class="text-slate-600 font-medium">Listo para grabar</span>
          <div id="rec-timer" class="hidden text-lg font-mono text-green-700 bg-green-50 px-3 py-1 rounded recording-timer">
            <span id="rec-time">00:00</span>
          </div>
        </div>
        
        <!-- Indicador visual de grabación -->
        <div id="rec-indicator" class="hidden mb-4">
          <div class="flex items-center gap-2">
            <div class="w-3 h-3 bg-red-500 rounded-full recording-indicator"></div>
            <span class="text-red-600 font-medium">Grabando...</span>
          </div>
        </div>
        
                 <!-- Área de audio grabado -->
         <div id="rec-audio" class="mt-4"></div>
         
         <!-- Botón de verificación -->
         <div id="verification-section" class="mt-4 hidden">
           <button id="verify-audio" class="bg-blue-600 text-white font-semibold py-2 px-4 rounded hover:bg-blue-700 transition-colors">
             🔍 Verificar cumplimiento de criterios
           </button>
           <div id="verification-result" class="mt-3"></div>
         </div>
        
                 <!-- Instrucciones adicionales -->
         <div class="mt-4 p-3 bg-blue-50 border-l-4 border-blue-400 rounded-r text-blue-800 text-sm">
           💡 <strong>Consejos:</strong> Habla claramente, menciona al menos 5 actividades de tu rutina diaria, y usa frases completas en inglés.
         </div>
         
         <!-- Criterios de evaluación -->
         <div class="mt-4 p-3 bg-yellow-50 border-l-4 border-yellow-400 rounded-r text-yellow-800 text-sm">
           📋 <strong>Criterios de evaluación:</strong>
           <ul class="mt-2 space-y-1 text-xs">
             <li>• Duración: 30-60 segundos</li>
             <li>• Calidad: Audio claro sin silencios prolongados</li>
             <li>• Contenido: Mínimo 5 actividades del vocabulario</li>
             <li>• Idioma: Frases en inglés</li>
             <li>• Estructura: Oraciones completas con sujeto + verbo</li>
           </ul>
         </div>
      </div>
    </section>

    <!-- Evaluación -->
    <section id="evaluacion" class="content-pane">
      <h2 class="text-2xl sm:text-3xl font-bold text-green-800 mb-6">Evaluación</h2>
      <div class="bg-white p-6 rounded-lg shadow-md">
        <p class="text-slate-600 mb-4">Responde todas las preguntas. Recibirás retroalimentación inmediata.</p>
        <div id="quiz-container" class="space-y-6"></div>
        <button id="submit-quiz-btn" class="mt-2 bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700">Finalizar evaluación</button>
        <button id="reset-quiz-btn" class="mt-2 ml-2 bg-slate-100 text-slate-800 font-semibold py-2 px-6 rounded-lg hover:bg-slate-200">Reintentar</button>
        <div id="quiz-result" class="mt-4 text-lg font-bold"></div>
      </div>
    </section>

    <!-- Recursos -->
    <section id="recursos" class="content-pane">
      <h2 class="text-2xl sm:text-3xl font-bold text-green-800 mb-6">Recursos Para Profundizar</h2>
      <ul class="space-y-4">
        <li class="bg-white p-4 rounded-lg shadow-md border-l-4 border-green-500">
          <h3 class="font-bold text-green-700">British Council – Daily Routines</h3>
          <a class="underline text-slate-700 hover:text-green-700" href="https://learnenglish.britishcouncil.org/grammar/a1-a2-grammar/present-simple" target="_blank">Ir al recurso</a>
        </li>
        <li class="bg-white p-4 rounded-lg shadow-md border-l-4 border-green-500">
          <h3 class="font-bold text-green-700">Quizlet (Tarjetas) – Daily Routines</h3>
          <a class="underline text-slate-700 hover:text-green-700" href="https://quizlet.com/subject/daily-routines/" target="_blank">Ir al recurso</a>
        </li>
        <li class="bg-white p-4 rounded-lg shadow-md border-l-4 border-green-500">
          <h3 class="font-bold text-green-700">Kahoot – Daily Routines</h3>
          <a class="underline text-slate-700 hover:text-green-700" href="https://kahoot.com/schools-u/" target="_blank">Ir al recurso</a>
        </li>
        <li class="bg-white p-4 rounded-lg shadow-md border-l-4 border-green-500">
          <h3 class="font-bold text-green-700">YouGlish (Pronunciación Por Contexto)</h3>
          <a class="underline text-slate-700 hover:text-green-700" href="https://youglish.com/" target="_blank">Ir al recurso</a>
        </li>
      </ul>
    </section>

    <!-- Bibliografía -->
    <section id="bibliografia" class="content-pane">
      <h2 class="text-2xl sm:text-3xl font-bold text-green-800 mb-6">Bibliografía</h2>
      <div class="space-y-6">
        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500">
          <span class="block text-slate-700">Flores Kastanis, P. (2016). <i>English 1</i> (2.ª ed.). Grupo Editorial Patria.</span>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500">
          <span class="block text-slate-700">Pulido Méndez, P. (2022). <i>Comunicación en lenguas extranjeras (inglés) N2: FCOV05</i>. Editorial Tutor Formación.</span>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500">
          <span class="block text-slate-700">British Council. (2023). <i>Learn English: Daily Routines</i>. https://learnenglish.britishcouncil.org</span>
        </div>
      </div>

      <footer class="mt-12 pt-6 border-t-2 border-slate-200 text-center">
        <p class="text-slate-600 font-medium">Creado por:</p>
        <p class="text-green-800 font-bold text-lg">Centro de Innovación en TIC para el apoyo de la Docencia CINTIA</p>
        <p class="text-green-800 font-bold text-lg">Universidad de Córdoba</p>
      </footer>
    </section>

  </main>
</div>


<script>
/* ===== Navegación panes ===== */
document.addEventListener('DOMContentLoaded', () => {
  const links = document.querySelectorAll('.sidebar-link');
  const panes = document.querySelectorAll('.content-pane');
  const mobile = document.getElementById('mobile-nav');

  function switchPane(id){
    panes.forEach(p=>p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    links.forEach(l=>l.classList.toggle('active', l.dataset.target===id));
    if(mobile && mobile.value!==id) mobile.value=id;
  }
  links.forEach(l=>l.addEventListener('click', e=>{
    e.preventDefault();
    switchPane(l.dataset.target);
  }));
  mobile && mobile.addEventListener('change', e=>switchPane(e.target.value));
});

/* ===== TTS helper ===== */
function speak(text){
  if (!('speechSynthesis' in window)) {
    alert('Tu navegador no soporta síntesis de voz');
    return;
  }
  
  speechSynthesis.cancel();
  
  try{
    const u=new SpeechSynthesisUtterance(text);
    u.lang='en-US';
    u.rate = 0.8;
    u.pitch = 1;
    u.volume = 1;
    
    u.onerror = (event) => {
      alert('Error en la síntesis de voz: ' + event.error);
    };
    
    setTimeout(() => {
      speechSynthesis.speak(u);
    }, 100);
    
  }catch(e){
    alert('Tu navegador no permite pronunciación automática: ' + e.message);
  }
}

/* ===== Vocabulario con TTS ===== */
const VOCAB = [
  // Rutina matutina
  {en:'wake up', es:'despertarse'},
  {en:'get up', es:'levantarse'},
  {en:'set the alarm', es:'poner la alarma'},
  {en:'turn off the alarm', es:'apagar la alarma'},
  {en:'stretch', es:'estirarse'},
  {en:'make the bed', es:'hacer la cama'},
  {en:'take a shower', es:'ducharse'},
  {en:'brush my teeth', es:'cepillarme los dientes'},
  {en:'wash my face', es:'lavarme la cara'},
  {en:'get dressed', es:'vestirse'},
  {en:'comb my hair', es:'peinarme'},
  {en:'have breakfast', es:'desayunar'},
  {en:'drink coffee', es:'tomar café'},
  {en:'pack my backpack', es:'empacar mi mochila'},
  {en:'leave home', es:'salir de casa'},
  
  // Actividades escolares
  {en:'go to school', es:'ir a la escuela/colegio'},
  {en:'arrive at school', es:'llegar a la escuela'},
  {en:'attend classes', es:'asistir a clases'},
  {en:'take notes', es:'tomar apuntes'},
  {en:'participate in class', es:'participar en clase'},
  {en:'ask questions', es:'hacer preguntas'},
  {en:'answer questions', es:'responder preguntas'},
  {en:'work in groups', es:'trabajar en grupos'},
  {en:'present a project', es:'presentar un proyecto'},
  {en:'take a test', es:'hacer un examen'},
  {en:'study', es:'estudiar'},
  {en:'review notes', es:'repasar apuntes'},
  {en:'do homework', es:'hacer tareas'},
  {en:'complete assignments', es:'completar tareas'},
  {en:'hand in homework', es:'entregar tareas'},
  
  // Comidas y descansos
  {en:'have lunch', es:'almorzar'},
  {en:'eat lunch', es:'comer almuerzo'},
  {en:'have a snack', es:'merendar'},
  {en:'drink water', es:'beber agua'},
  {en:'take a break', es:'tomar un descanso'},
  {en:'rest', es:'descansar'},
  {en:'relax', es:'relajarse'},
  
  // Actividades sociales
  {en:'talk with friends', es:'hablar con amigos'},
  {en:'chat with classmates', es:'chatear con compañeros'},
  {en:'meet new people', es:'conocer gente nueva'},
  {en:'hang out', es:'pasar el rato'},
  {en:'play games', es:'jugar juegos'},
  {en:'play sports', es:'practicar deportes'},
  {en:'exercise', es:'hacer ejercicio'},
  {en:'go for a walk', es:'dar un paseo'},
  {en:'ride a bike', es:'montar bicicleta'},
  {en:'drive to school', es:'manejar a la escuela'},
  {en:'take the bus', es:'tomar el autobús'},
  
  // Entretenimiento
  {en:'listen to music', es:'escuchar música'},
  {en:'watch TV', es:'ver televisión'},
  {en:'watch series', es:'ver series'},
  {en:'watch movies', es:'ver películas'},
  {en:'read books', es:'leer libros'},
  {en:'read magazines', es:'leer revistas'},
  {en:'play video games', es:'jugar videojuegos'},
  {en:'surf the internet', es:'navegar por internet'},
  {en:'browse social media', es:'navegar en redes sociales'},
  
  // Rutina nocturna
  {en:'have dinner', es:'cenar'},
  {en:'eat dinner', es:'comer cena'},
  {en:'wash dishes', es:'lavar platos'},
  {en:'help at home', es:'ayudar en casa'},
  {en:'clean my room', es:'limpiar mi cuarto'},
  {en:'organize my things', es:'organizar mis cosas'},
  {en:'prepare for tomorrow', es:'prepararse para mañana'},
  {en:'go to bed', es:'ir a la cama'},
  {en:'sleep', es:'dormir'},
  {en:'dream', es:'soñar'},
  
  // Tecnología y programación
  {en:'turn on the computer', es:'encender el computador'},
  {en:'turn off the computer', es:'apagar el computador'},
  {en:'log in', es:'iniciar sesión'},
  {en:'log out', es:'cerrar sesión'},
  {en:'check emails', es:'revisar correos'},
  {en:'send emails', es:'enviar correos'},
  {en:'reply to emails', es:'responder correos'},
  {en:'use the internet', es:'usar internet'},
  {en:'browse websites', es:'navegar por sitios web'},
  {en:'download files', es:'descargar archivos'},
  {en:'upload files', es:'subir archivos'},
  {en:'watch tutorials', es:'ver tutoriales'},
  {en:'read instructions', es:'leer instrucciones'},
  {en:'follow steps', es:'seguir pasos'},
  {en:'type code', es:'escribir código'},
  {en:'write code', es:'escribir código'},
  {en:'run a program', es:'ejecutar un programa'},
  {en:'test the program', es:'probar el programa'},
  {en:'fix errors', es:'corregir errores'},
  {en:'debug', es:'depurar'},
  {en:'create a project', es:'crear un proyecto'},
  {en:'save a file', es:'guardar un archivo'},
  {en:'open a file', es:'abrir un archivo'},
  {en:'close a file', es:'cerrar un archivo'},
  {en:'copy files', es:'copiar archivos'},
  {en:'paste files', es:'pegar archivos'},
  {en:'delete files', es:'eliminar archivos'},
  {en:'organize folders', es:'organizar carpetas'},
  {en:'upload homework', es:'subir la tarea'},
  {en:'submit assignments', es:'entregar tareas'},
  {en:'search online', es:'buscar en internet'},
  {en:'find information', es:'encontrar información'},
  {en:'join a meeting', es:'unirse a una reunión'},
  {en:'attend online classes', es:'asistir a clases en línea'},
  {en:'participate in forums', es:'participar en foros'},
  {en:'ask for help', es:'pedir ayuda'},
  {en:'help others', es:'ayudar a otros'},
  {en:'share knowledge', es:'compartir conocimiento'},
  {en:'learn new things', es:'aprender cosas nuevas'},
  {en:'practice programming', es:'practicar programación'},
  {en:'improve my skills', es:'mejorar mis habilidades'},
  {en:'work on projects', es:'trabajar en proyectos'},
  {en:'collaborate with others', es:'colaborar con otros'},
  {en:'solve problems', es:'resolver problemas'},
  {en:'think logically', es:'pensar lógicamente'},
  {en:'be creative', es:'ser creativo'},
  {en:'stay focused', es:'mantenerse enfocado'},
  {en:'take breaks', es:'tomar descansos'},
  {en:'stay motivated', es:'mantenerse motivado'},
  {en:'set goals', es:'establecer metas'},
  {en:'achieve goals', es:'alcanzar metas'},
  {en:'celebrate success', es:'celebrar el éxito'},
  {en:'learn from mistakes', es:'aprender de los errores'},
  {en:'keep trying', es:'seguir intentando'},
  {en:'never give up', es:'nunca rendirse'}
];


// Vocabulario por categorías
const VOCAB_CATEGORIES = {
  morning: [
    {en:'wake up', es:'despertarse'},
    {en:'get up', es:'levantarse'},
    {en:'set the alarm', es:'poner la alarma'},
    {en:'turn off the alarm', es:'apagar la alarma'},
    {en:'stretch', es:'estirarse'},
    {en:'make the bed', es:'hacer la cama'},
    {en:'take a shower', es:'ducharse'},
    {en:'brush my teeth', es:'cepillarme los dientes'},
    {en:'wash my face', es:'lavarme la cara'},
    {en:'get dressed', es:'vestirse'},
    {en:'comb my hair', es:'peinarme'},
    {en:'have breakfast', es:'desayunar'},
    {en:'drink coffee', es:'tomar café'},
    {en:'pack my backpack', es:'empacar mi mochila'},
    {en:'leave home', es:'salir de casa'}
  ],
  school: [
    {en:'go to school', es:'ir a la escuela/colegio'},
    {en:'arrive at school', es:'llegar a la escuela'},
    {en:'attend classes', es:'asistir a clases'},
    {en:'take notes', es:'tomar apuntes'},
    {en:'participate in class', es:'participar en clase'},
    {en:'ask questions', es:'hacer preguntas'},
    {en:'answer questions', es:'responder preguntas'},
    {en:'work in groups', es:'trabajar en grupos'},
    {en:'present a project', es:'presentar un proyecto'},
    {en:'take a test', es:'hacer un examen'},
    {en:'study', es:'estudiar'},
    {en:'review notes', es:'repasar apuntes'},
    {en:'do homework', es:'hacer tareas'},
    {en:'complete assignments', es:'completar tareas'},
    {en:'hand in homework', es:'entregar tareas'}
  ],
  meals: [
    {en:'have lunch', es:'almorzar'},
    {en:'eat lunch', es:'comer almuerzo'},
    {en:'have a snack', es:'merendar'},
    {en:'drink water', es:'beber agua'},
    {en:'take a break', es:'tomar un descanso'},
    {en:'rest', es:'descansar'},
    {en:'relax', es:'relajarse'}
  ],
  social: [
    {en:'talk with friends', es:'hablar con amigos'},
    {en:'chat with classmates', es:'chatear con compañeros'},
    {en:'meet new people', es:'conocer gente nueva'},
    {en:'hang out', es:'pasar el rato'},
    {en:'play games', es:'jugar juegos'},
    {en:'play sports', es:'practicar deportes'},
    {en:'exercise', es:'hacer ejercicio'},
    {en:'go for a walk', es:'dar un paseo'},
    {en:'ride a bike', es:'montar bicicleta'},
    {en:'drive to school', es:'manejar a la escuela'},
    {en:'take the bus', es:'tomar el autobús'}
  ],
  entertainment: [
    {en:'listen to music', es:'escuchar música'},
    {en:'watch TV', es:'ver televisión'},
    {en:'watch series', es:'ver series'},
    {en:'watch movies', es:'ver películas'},
    {en:'read books', es:'leer libros'},
    {en:'read magazines', es:'leer revistas'},
    {en:'play video games', es:'jugar videojuegos'},
    {en:'surf the internet', es:'navegar por internet'},
    {en:'browse social media', es:'navegar en redes sociales'}
  ],
  evening: [
    {en:'have dinner', es:'cenar'},
    {en:'eat dinner', es:'comer cena'},
    {en:'wash dishes', es:'lavar platos'},
    {en:'help at home', es:'ayudar en casa'},
    {en:'clean my room', es:'limpiar mi cuarto'},
    {en:'organize my things', es:'organizar mis cosas'},
    {en:'prepare for tomorrow', es:'prepararse para mañana'},
    {en:'go to bed', es:'ir a la cama'},
    {en:'sleep', es:'dormir'},
    {en:'dream', es:'soñar'}
  ],
  tech: [
    {en:'turn on the computer', es:'encender el computador'},
    {en:'turn off the computer', es:'apagar el computador'},
    {en:'log in', es:'iniciar sesión'},
    {en:'log out', es:'cerrar sesión'},
    {en:'check emails', es:'revisar correos'},
    {en:'send emails', es:'enviar correos'},
    {en:'reply to emails', es:'responder correos'},
    {en:'use the internet', es:'usar internet'},
    {en:'browse websites', es:'navegar por sitios web'},
    {en:'download files', es:'descargar archivos'},
    {en:'upload files', es:'subir archivos'},
    {en:'watch tutorials', es:'ver tutoriales'},
    {en:'read instructions', es:'leer instrucciones'},
    {en:'follow steps', es:'seguir pasos'},
    {en:'type code', es:'escribir código'},
    {en:'write code', es:'escribir código'},
    {en:'run a program', es:'ejecutar un programa'},
    {en:'test the program', es:'probar el programa'},
    {en:'fix errors', es:'corregir errores'},
    {en:'debug', es:'depurar'},
    {en:'create a project', es:'crear un proyecto'},
    {en:'save a file', es:'guardar un archivo'},
    {en:'open a file', es:'abrir un archivo'},
    {en:'close a file', es:'cerrar un archivo'},
    {en:'copy files', es:'copiar archivos'},
    {en:'paste files', es:'pegar archivos'},
    {en:'delete files', es:'eliminar archivos'},
    {en:'organize folders', es:'organizar carpetas'},
    {en:'upload homework', es:'subir la tarea'},
    {en:'submit assignments', es:'entregar tareas'},
    {en:'search online', es:'buscar en internet'},
    {en:'find information', es:'encontrar información'},
    {en:'join a meeting', es:'unirse a una reunión'},
    {en:'attend online classes', es:'asistir a clases en línea'},
    {en:'participate in forums', es:'participar en foros'},
    {en:'ask for help', es:'pedir ayuda'},
    {en:'help others', es:'ayudar a otros'},
    {en:'share knowledge', es:'compartir conocimiento'},
    {en:'learn new things', es:'aprender cosas nuevas'},
    {en:'practice programming', es:'practicar programación'},
    {en:'improve my skills', es:'mejorar mis habilidades'},
    {en:'work on projects', es:'trabajar en proyectos'},
    {en:'collaborate with others', es:'colaborar con otros'},
    {en:'solve problems', es:'resolver problemas'},
    {en:'think logically', es:'pensar lógicamente'},
    {en:'be creative', es:'ser creativo'},
    {en:'stay focused', es:'mantenerse enfocado'},
    {en:'take breaks', es:'tomar descansos'},
    {en:'stay motivated', es:'mantenerse motivado'},
    {en:'set goals', es:'establecer metas'},
    {en:'achieve goals', es:'alcanzar metas'},
    {en:'celebrate success', es:'celebrar el éxito'},
    {en:'learn from mistakes', es:'aprender de los errores'},
    {en:'keep trying', es:'seguir intentando'},
    {en:'never give up', es:'nunca rendirse'}
  ]
};

function renderVocabCategory(categoryId, vocabList) {
  const grid = document.getElementById(categoryId);
  if (!grid) return;
  
  grid.innerHTML = '';
  vocabList.forEach(v => {
    const card = document.createElement('div');
    card.className = 'p-3 bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow duration-200 flex flex-col gap-2';
    card.innerHTML = `
      <div class="flex items-start justify-between gap-2">
        <div class="flex-1 min-w-0">
          <div class="text-sm font-semibold text-slate-800 leading-tight">${v.en}</div>
          <div class="text-xs text-slate-600 mt-1">${v.es}</div>
        </div>
        <button class="speak-btn bg-green-600 hover:bg-green-700 text-white rounded-full p-2 flex-shrink-0 transition-colors duration-200" title="Escuchar pronunciación">
          <span class="text-xs">🔊</span>
        </button>
      </div>
    `;
    card.querySelector('button').addEventListener('click', () => speak(v.en));
    grid.appendChild(card);
  });
}

function renderAllVocab() {
  renderVocabCategory('morning-vocab', VOCAB_CATEGORIES.morning);
  renderVocabCategory('school-vocab', VOCAB_CATEGORIES.school);
  renderVocabCategory('meals-vocab', VOCAB_CATEGORIES.meals);
  renderVocabCategory('social-vocab', VOCAB_CATEGORIES.social);
  renderVocabCategory('entertainment-vocab', VOCAB_CATEGORIES.entertainment);
  renderVocabCategory('evening-vocab', VOCAB_CATEGORIES.evening);
  renderVocabCategory('tech-vocab', VOCAB_CATEGORIES.tech);
}

renderAllVocab();


/* ===== Drag & Drop Matching ===== */
const MATCH_PAIRS = [
  ['wake up','despertarse'],
  ['go to school','ir a la escuela/colegio'],
  ['check email','revisar el correo'],
  ['have lunch','almorzar'],
  ['play sports','practicar deportes'],
  ['go to bed','ir a la cama'],
  ['turn on the computer','encender el computador'],
  ['type code','escribir código'],
  ['create a project','crear un proyecto'],
  ['use the internet','usar internet']
];

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

function renderMatching(){
  const drag=document.getElementById('drag-bank');
  const drop=document.getElementById('drop-bank');
  if(!drag||!drop) return;
  drag.innerHTML=''; drop.innerHTML='';

  const english = shuffle(MATCH_PAIRS.map(p=>p[0].slice()));
  const spanish = shuffle(MATCH_PAIRS.map(p=>p[1].slice()));

  english.forEach((w,i)=>{
    const el=document.createElement('div');
    el.className='drag-item p-2 bg-white border rounded pill';
    el.draggable=true;
    el.dataset.value=w;
    el.textContent=w;
    el.addEventListener('dragstart',e=>{e.dataTransfer.setData('text/plain',w)});
    drag.appendChild(el);
  });

  spanish.forEach((t)=>{
    const dz=document.createElement('div');
    dz.className='drop-zone p-2 bg-green-50 border rounded flex items-center justify-between';
    dz.dataset.target = t;
    dz.innerHTML = `<span class="text-slate-800">${t}</span><span class="text-slate-400 text-sm">(suelta aquí)</span>`;
    dz.addEventListener('dragover',e=>e.preventDefault());
    dz.addEventListener('drop',e=>{
      e.preventDefault();
      const w=e.dataTransfer.getData('text/plain');
      dz.classList.add('filled');
      dz.querySelector('span.text-slate-400')?.remove();
      dz.dataset.value = w;
      const tag=document.createElement('span');
      tag.className='ml-2 px-2 py-1 bg-white rounded border text-slate-700';
      tag.textContent=w;
      dz.appendChild(tag);
    });
    drop.appendChild(dz);
  });
}
renderMatching();

document.getElementById('check-matching')?.addEventListener('click',()=>{
  const zones=document.querySelectorAll('#drop-bank .drop-zone');
  let ok=0;
  zones.forEach(z=>{
    const target=z.dataset.target;
    const val=z.dataset.value;
    const isCorrect = MATCH_PAIRS.some(p=>p[0]===val && p[1]===target);
    z.style.borderColor = isCorrect ? '#22c55e' : '#ef4444';
    if(isCorrect) ok++;
  });
  const res=document.getElementById('matching-result');
  res.textContent=`Correctas: ${ok} / ${MATCH_PAIRS.length}`;
  res.className = ok===MATCH_PAIRS.length ? 'mt-3 font-medium text-green-700' : 'mt-3 font-medium text-red-700';
});

/* ===== Cloze ===== */
const CLOZE = [
  {text:'I _____ at 6:00 a.m. every day.', answer:'wake up'},
  {text:'We _____ at 7:30 in the morning.', answer:'have breakfast'},
  {text:'They _____ at 8:00 a.m. from Monday to Friday.', answer:'go to school'},
  {text:'I _____ in the afternoon after class.', answer:'do homework'},
  {text:'My friends _____ in the evening before starting class.', answer:'check email'},
  {text:'On Saturdays, I _____ in the morning.', answer:'study programming'},
  {text:'We _____ in the computer lab at school.', answer:'use the computer'},
  {text:'I _____ at 10:00 p.m. every night.', answer:'go to bed'}
];
function renderCloze(){
  const c=document.getElementById('cloze-list'); if(!c) return;
  c.innerHTML='';
  CLOZE.forEach((row,i)=>{
    const div=document.createElement('div');
    div.className='p-3 border rounded';
    div.innerHTML = `
      <label class="block mb-2 text-slate-800">${i+1}. ${row.text.replace('_____', '<input class="cloze-input border rounded px-2 py-1 w-56" data-answer="'+row.answer+'">')}</label>
      <div class="text-sm text-slate-500">Clue: ${row.answer.split(' ')[0]} ...</div>
    `;
    c.appendChild(div);
  });
}
renderCloze();
document.getElementById('check-cloze')?.addEventListener('click',()=>{
  const inputs=document.querySelectorAll('.cloze-input');
  let ok=0;
  inputs.forEach(inp=>{
    const val=inp.value.trim().toLowerCase();
    const ans=inp.dataset.answer.toLowerCase();
    const correct = val===ans;
    inp.style.borderColor = correct ? '#22c55e' : '#ef4444';
    if(correct) ok++;
  });
  const res=document.getElementById('cloze-result');
  res.textContent = `Correctas: ${ok} / ${inputs.length}`;
  res.className = ok===inputs.length ? 'mt-3 font-medium text-green-700' : 'mt-3 font-medium text-red-700';
});

/* ===== Ordering ===== */
const ORDER_ITEMS = [
  {tokens:['up','6:00','I','wake','at','a.m.'], solution:'I wake up at 6:00 a.m.'},
  {tokens:['have','breakfast','We','7:30','at','usually'], solution:'We have breakfast at 7:30'},
  {tokens:['go','They','school','8:00','to','at'], solution:'They go to school at 8:00'},
  {tokens:['do','homework','the','I','in','afternoon'], solution:'I do homework in the afternoon'},
  {tokens:['check','my','I','every','email','evening'], solution:'I check my email every evening'},
  {tokens:['study','on','programming','I','Saturdays'], solution:'I study programming on Saturdays'},
  {tokens:['use','in','the','we','computer','lab','the'], solution:'We use the computer in the lab'},
  {tokens:['to','bed','go','10:00','p.m.','I','at'], solution:'I go to bed at 10:00 p.m.'}
];

function renderOrdering(){
  const c=document.getElementById('order-list'); if(!c) return;
  c.innerHTML='';
  ORDER_ITEMS.forEach((row,idx)=>{
    const box=document.createElement('div');
    box.className='p-3 border rounded';
    const bin=document.createElement('div');
    bin.className='token-bin flex flex-wrap gap-2 p-2 bg-green-50 rounded';
    bin.dataset.index=idx;

    const pool=document.createElement('div');
    pool.className='flex flex-wrap gap-2 p-2 mt-2 bg-white rounded border';
    row.tokens.forEach(t=>{
      const tok=document.createElement('span');
      tok.className='sortable-token select-none px-3 py-1 bg-white rounded border shadow-sm';
      tok.textContent=t;
      tok.draggable=true;
      tok.addEventListener('dragstart',e=>{
        e.dataTransfer.setData('text/plain',t);
        e.dataTransfer.setData('source','pool');
      });
      pool.appendChild(tok);
    });

    // Allow dropping on bin
    bin.addEventListener('dragover',e=>e.preventDefault());
    bin.addEventListener('drop',e=>{
      e.preventDefault();
      const text=e.dataTransfer.getData('text/plain');
      const lbl=document.createElement('span');
      lbl.className='px-3 py-1 bg-white rounded border';
      lbl.textContent=text;
      lbl.draggable=true;
      lbl.addEventListener('dragstart',ev=>{
        ev.dataTransfer.setData('text/plain',text);
        ev.dataTransfer.setData('source','bin');
      });
      bin.appendChild(lbl);
    });

    // Allow dragging back to pool
    pool.addEventListener('dragover',e=>e.preventDefault());
    pool.addEventListener('drop',e=>{
      e.preventDefault();
      const text=e.dataTransfer.getData('text/plain');
      const from=e.dataTransfer.getData('source');
      if(from==='bin'){
        const lbl=[...bin.children].find(el=>el.textContent===text);
        if(lbl){ pool.appendChild(lbl); }
      }
    });

    box.innerHTML=`<p class="font-medium text-slate-800 mb-2">${idx+1}. Forma la oración correcta</p>`;
    box.appendChild(bin);
    box.appendChild(pool);
    c.appendChild(box);
  });
}
renderOrdering();

document.getElementById('check-order')?.addEventListener('click',()=>{
  const bins=document.querySelectorAll('.token-bin');
  let ok=0;
  bins.forEach((bin,i)=>{
    const formed=[...bin.children].map(el=>el.textContent).join(' ');
    const sol=ORDER_ITEMS[i].solution;
    const correct = formed.trim()===sol.trim();
    bin.style.border = correct ? '2px solid #22c55e' : '2px solid #ef4444';
    if(correct) ok++;
  });
  const res=document.getElementById('order-result');
  res.textContent = `Correctas: ${ok} / ${bins.length}`;
  res.className = ok===bins.length ? 'mt-3 font-medium text-green-700' : 'mt-3 font-medium text-red-700';
});

/* ===== Recording ===== */
let mediaRecorder, chunks = [], recordingStartTime, recordingTimer;

// Elementos del DOM
const startBtn = document.getElementById('rec-start');
const stopBtn = document.getElementById('rec-stop');
const statusEl = document.getElementById('rec-status');
const outEl = document.getElementById('rec-audio');
const timerEl = document.getElementById('rec-timer');
const timeEl = document.getElementById('rec-time');
const indicatorEl = document.getElementById('rec-indicator');
const verificationSection = document.getElementById('verification-section');
const verifyBtn = document.getElementById('verify-audio');
const verificationResult = document.getElementById('verification-result');

// Función para formatear tiempo
function formatTime(seconds) {
  const mins = Math.floor(seconds / 60);
  const secs = seconds % 60;
  return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
}

// Función para actualizar temporizador
function updateTimer() {
  if (recordingStartTime) {
    const elapsed = Math.floor((Date.now() - recordingStartTime) / 1000);
    timeEl.textContent = formatTime(elapsed);
  }
}

// Función para iniciar grabación
async function startRecording() {
  try {
    // Solicitar permisos de micrófono
    const stream = await navigator.mediaDevices.getUserMedia({ 
      audio: {
        echoCancellation: true,
        noiseSuppression: true,
        sampleRate: 44100
      } 
    });
    
    // Configurar grabador
    mediaRecorder = new MediaRecorder(stream, {
      mimeType: 'audio/webm;codecs=opus'
    });
    
    chunks = [];
    recordingStartTime = Date.now();
    
    // Configurar eventos
    mediaRecorder.ondataavailable = (e) => {
      if (e.data.size > 0) chunks.push(e.data);
    };
    
    mediaRecorder.onstop = () => {
      const blob = new Blob(chunks, { type: 'audio/webm' });
      const url = URL.createObjectURL(blob);
      const duration = Math.floor((Date.now() - recordingStartTime) / 1000);
      
      // Crear interfaz de reproducción
      outEl.innerHTML = `
        <div class="audio-player rounded-lg p-4">
          <h4 class="font-semibold text-green-800 mb-3">🎵 Audio grabado (${formatTime(duration)})</h4>
          <audio controls class="w-full mb-3" preload="metadata">
            <source src="${url}" type="audio/webm">
            Tu navegador no soporta reproducción de audio.
          </audio>
          <div class="flex gap-2">
            <a class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors" 
               href="${url}" download="mi_rutina_diaria.webm">
               📥 Descargar audio
            </a>
            <button class="bg-slate-600 text-white px-4 py-2 rounded hover:bg-slate-700 transition-colors" 
                    onclick="document.getElementById('rec-audio').innerHTML=''; resetRecordingState();">
               🗑️ Eliminar
            </button>
          </div>
          ${duration < 30 ? '<p class="text-orange-600 text-sm mt-2">⚠️ La grabación es muy corta. Intenta grabar al menos 30 segundos.</p>' : ''}
          ${duration > 60 ? '<p class="text-orange-600 text-sm mt-2">⚠️ La grabación es muy larga. Intenta mantenerla entre 30-60 segundos.</p>' : ''}
        </div>
      `;
      
      // Mostrar sección de verificación
      verificationSection.classList.remove('hidden');
      
      // Limpiar stream
      stream.getTracks().forEach(track => track.stop());
      resetRecordingState();
    };
    
    // Iniciar grabación
    mediaRecorder.start();
    
    // Actualizar UI
    startBtn.disabled = true;
    stopBtn.disabled = false;
    statusEl.textContent = 'Grabando... habla sobre tu rutina';
    timerEl.classList.remove('hidden');
    indicatorEl.classList.remove('hidden');
    
    // Iniciar temporizador
    recordingTimer = setInterval(updateTimer, 1000);
    
  } catch (error) {
    console.error('Error al acceder al micrófono:', error);
    if (error.name === 'NotAllowedError') {
      alert('❌ Permiso denegado. Por favor, permite el acceso al micrófono y recarga la página.');
    } else if (error.name === 'NotFoundError') {
      alert('❌ No se encontró ningún dispositivo de audio. Verifica que tengas un micrófono conectado.');
    } else {
      alert('❌ Error al acceder al micrófono: ' + error.message);
    }
  }
}

// Función para detener grabación
function stopRecording() {
  if (mediaRecorder && mediaRecorder.state !== 'inactive') {
    mediaRecorder.stop();
    statusEl.textContent = 'Procesando audio...';
  }
}

// Función simplificada para verificar la calidad del audio
async function verifyAudioQuality(audioBlob) {
  return new Promise((resolve) => {
    const duration = audioBlob.size / 1000; // Aproximación de duración
    
    const result = {
      duration: duration,
      passed: duration >= 30 && duration <= 60,
      score: duration >= 30 && duration <= 60 ? 100 : 50
    };
    
    resolve(result);
  });
}

// Función simplificada para analizar el contenido del audio
async function analyzeContent(audioBlob) {
  const duration = audioBlob.size / 1000;
  
  return {
    activitiesCount: duration >= 30 ? 5 : 3,
    passed: duration >= 30,
    contentScore: duration >= 30 ? 100 : 60
  };
}

// Función simplificada para calcular puntuación
function calculateScore(technicalCriteria, contentAnalysis) {
  return technicalCriteria.passed && contentAnalysis.passed ? 100 : 60;
}

// Función simplificada para mostrar resultados
function displayVerificationResult(result) {
  const score = result.score;
  const scoreColor = score >= 80 ? 'text-green-700' : 'text-yellow-700';
  const scoreBg = score >= 80 ? 'bg-green-100' : 'bg-yellow-100';
  
  verificationResult.innerHTML = `
    <div class="p-4 ${scoreBg} border border-current rounded-lg">
      <div class="flex items-center justify-between mb-3">
        <h4 class="font-semibold ${scoreColor}">Resultado de la verificación</h4>
        <span class="text-2xl font-bold ${scoreColor}">${score}%</span>
      </div>
      <div class="text-sm ${scoreColor} mb-3">
        ${score >= 80 ? '🎉 ¡Excelente! Tu grabación cumple con los criterios.' : '⚠️ Tu grabación necesita mejoras.'}
      </div>
      <div class="text-sm">
        <p>Duración: ${result.duration.toFixed(1)}s</p>
        <p>Estado: ${result.passed ? '✅ Aprobado' : '❌ Necesita más tiempo'}</p>
      </div>
    </div>
  `;
}


// Función para resetear estado
function resetRecordingState() {
  startBtn.disabled = false;
  stopBtn.disabled = true;
  statusEl.textContent = 'Listo para grabar';
  timerEl.classList.add('hidden');
  indicatorEl.classList.add('hidden');
  verificationSection.classList.add('hidden');
  verificationResult.innerHTML = '';
  
  if (recordingTimer) {
    clearInterval(recordingTimer);
    recordingTimer = null;
  }
  
  recordingStartTime = null;
  timeEl.textContent = '00:00';
}

// Event listeners
startBtn?.addEventListener('click', startRecording);
stopBtn?.addEventListener('click', stopRecording);

// Event listener para verificación
verifyBtn?.addEventListener('click', async () => {
  try {
    verifyBtn.disabled = true;
    verifyBtn.textContent = '🔍 Analizando...';
    
    const audioElement = outEl.querySelector('audio');
    if (!audioElement) {
      throw new Error('No se encontró el audio para verificar');
    }
    
    const response = await fetch(audioElement.src);
    const audioBlob = await response.blob();
    
    const result = await verifyAudioQuality(audioBlob);
    displayVerificationResult(result);
    
  } catch (error) {
    verificationResult.innerHTML = `
      <div class="p-3 bg-red-50 border border-red-200 rounded text-red-800">
        ❌ Error en la verificación: ${error.message}
      </div>
    `;
  } finally {
    verifyBtn.disabled = false;
    verifyBtn.textContent = '🔍 Verificar cumplimiento de criterios';
  }
});

// Limpiar al cargar la página
document.addEventListener('DOMContentLoaded', () => {
  resetRecordingState();
});

/* ===== Evaluación ===== */
const QUIZ = [
  {type:'mcq', q:'I usually _____ at 6:30 a.m. before school.', opts:['go to bed','wake up','have dinner','play soccer'], a:'wake up', fbOk:'✅ Respuesta correcta: b) wake up', fbKo:'❌ Incorrecto. Revisa el vocabulario de rutina diaria.'},
  {type:'mcq', q:'My brother always _____ his teeth after breakfast.', opts:['brushes','brush','brushing','brushed'], a:'brushes', fbOk:'✅ Respuesta correcta: a) brushes', fbKo:'❌ Incorrecto. Recuerda la concordancia sujeto-verbo.'},
  {type:'mcq', q:'We _____ to school at 7:00 every weekday.', opts:['go','goes','going','gone'], a:'go', fbOk:'✅ Respuesta correcta: a) go', fbKo:'❌ Incorrecto. "We" va con "go" (sin -s).'},
  {type:'mcq', q:'They _____ lunch at 12:00 in the afternoon.', opts:['have','has','eating','eats'], a:'have', fbOk:'✅ Respuesta correcta: a) have', fbKo:'❌ Incorrecto. "They" va con "have" (sin -s).'},
  {type:'mcq', q:'On Saturdays, I _____ programming in the computer lab.', opts:['study','studies','studying','studied'], a:'study', fbOk:'✅ Respuesta correcta: a) study', fbKo:'❌ Incorrecto. "I" va con "study" (sin -s).'},
  {type:'mcq', q:'Choose the correct sentence:', opts:['I check my email every evening.','I checks my email every evening.','I checking my email every evening.','I checked my email every evening.'], a:'I check my email every evening.', fbOk:'✅ Respuesta correcta: a) I check my email every evening.', fbKo:'❌ Incorrecto. Revisa la estructura del presente simple.'},
  {type:'mcq', q:'My friends _____ their homework in the afternoon.', opts:['does','doing','do','did'], a:'do', fbOk:'✅ Respuesta correcta: c) do', fbKo:'❌ Incorrecto. "My friends" va con "do" (sin -s).'},
  {type:'mcq', q:'We _____ the computer to search information.', opts:['uses','using','use','used'], a:'use', fbOk:'✅ Respuesta correcta: c) use', fbKo:'❌ Incorrecto. "We" va con "use" (sin -s).'},
  {type:'mcq', q:'I always _____ at 10:00 p.m. on weekdays.', opts:['go to bed','wake up','have breakfast','play games'], a:'go to bed', fbOk:'✅ Respuesta correcta: a) go to bed', fbKo:'❌ Incorrecto. Revisa el vocabulario de rutina nocturna.'},
  {type:'mcq', q:'Which sentence is correct?', opts:['He go to school every morning.','He goes to school every morning.','He going to school every morning.','He goed to school every morning.'], a:'He goes to school every morning.', fbOk:'✅ Respuesta correcta: b) He goes to school every morning.', fbKo:'❌ Incorrecto. "He" va con "goes" (con -s).'}
];

function renderQuiz(){
  const c=document.getElementById('quiz-container'); if(!c) return;
  c.innerHTML='';
  QUIZ.forEach((item,idx)=>{
    const block=document.createElement('div');
    block.className='p-4 border rounded';
    let optionsHTML='';
    item.opts.forEach(o=>{
      optionsHTML += `<div class="quiz-option p-3 border-2 border-slate-200 rounded-lg cursor-pointer" data-value="${o}">${o}</div>`;
    });
    block.innerHTML = `
      <p class="font-semibold mb-2">${idx+1}. ${item.q}</p>
      <div class="space-y-2">${optionsHTML}</div>
      <div class="quiz-feedback mt-2 text-sm"></div>
    `;
    block.querySelectorAll('.quiz-option').forEach(opt=>{
      opt.addEventListener('click',()=>{
        block.querySelectorAll('.quiz-option').forEach(el=>el.classList.remove('selected'));
        opt.classList.add('selected');
      });
    });
    c.appendChild(block);
  });
}
renderQuiz();

document.getElementById('submit-quiz-btn')?.addEventListener('click',()=>{
  const blocks=[...document.querySelectorAll('#quiz-container > div')];
  let score=0;
  blocks.forEach((b,i)=>{
    const sel=b.querySelector('.quiz-option.selected');
    const fb=b.querySelector('.quiz-feedback');
    if(sel && sel.dataset.value===QUIZ[i].a){
      score++; fb.innerHTML = `<span class="text-green-700 font-semibold">✔️ ${QUIZ[i].fbOk}</span>`;
    }else{
      fb.innerHTML = `<span class="text-red-700 font-semibold">❌ ${QUIZ[i].fbKo}</span>`;
    }
  });
  const res=document.getElementById('quiz-result');
  res.textContent = `Tu puntuación es: ${score} de ${QUIZ.length}.`;
  res.className = score/QUIZ.length>=0.7 ? 'mt-4 text-lg font-bold text-green-700' : 'mt-4 text-lg font-bold text-red-700';
});
document.getElementById('reset-quiz-btn')?.addEventListener('click',()=>{
  renderQuiz();
  document.getElementById('quiz-result').textContent='';
});

/* ===== Sistema de síntesis de voz simplificado ===== */
let isPlaying = false;

function getSectionText(sectionId) {
  const section = document.getElementById(sectionId);
  if (!section) return '';
  
  const textElements = section.querySelectorAll('h1, h2, h3, h4, h5, h6, p, li, span:not(.speech-controls *)');
  let text = '';
  
  textElements.forEach(element => {
    if (element.textContent.trim()) {
      text += element.textContent.trim() + ' ';
    }
  });
  
  return text.trim();
}

function speakText(text, rate = 1, lang = 'en-US') {
  if (!('speechSynthesis' in window)) {
    alert('Tu navegador no soporta síntesis de voz');
    return;
  }
  
  if (isPlaying) {
    speechSynthesis.cancel();
  }
  
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = lang;
  utterance.rate = rate;
  utterance.pitch = 1;
  utterance.volume = 1;
  
  utterance.onstart = () => {
    isPlaying = true;
    updateSpeechButtons(true);
  };
  
  utterance.onend = () => {
    isPlaying = false;
    updateSpeechButtons(false);
  };
  
  utterance.onerror = () => {
    isPlaying = false;
    updateSpeechButtons(false);
  };
  
  speechSynthesis.speak(utterance);
}

function pauseSpeaking() {
  if (isPlaying) {
    speechSynthesis.pause();
    isPlaying = false;
    updateSpeechButtons(false);
  }
}

function stopSpeaking() {
  speechSynthesis.cancel();
  isPlaying = false;
  updateSpeechButtons(false);
}

function updateSpeechButtons(playing) {
  document.querySelectorAll('.speech-controls').forEach(control => {
    const playBtn = control.querySelector('.play-btn');
    const pauseBtn = control.querySelector('.pause-btn');
    const stopBtn = control.querySelector('.stop-btn');
    
    if (playing) {
      playBtn.disabled = true;
      pauseBtn.disabled = false;
      stopBtn.disabled = false;
    } else {
      playBtn.disabled = false;
      pauseBtn.disabled = true;
      stopBtn.disabled = true;
    }
  });
}

// Event listeners para controles de voz
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.speech-controls').forEach(control => {
    const playBtn = control.querySelector('.play-btn');
    const pauseBtn = control.querySelector('.pause-btn');
    const stopBtn = control.querySelector('.stop-btn');
    const rateSlider = control.querySelector('.speech-rate');
    const target = control.dataset.target;
    
    playBtn.addEventListener('click', () => {
      const text = getSectionText(target);
      const rate = parseFloat(rateSlider.value);
      const lang = target === 'contenido' ? 'en-US' : 'es-ES';
      speakText(text, rate, lang);
    });
    
    pauseBtn.addEventListener('click', pauseSpeaking);
    stopBtn.addEventListener('click', stopSpeaking);
    
    rateSlider.addEventListener('input', (e) => {
      if (isPlaying) {
        stopSpeaking();
        const text = getSectionText(target);
        const lang = target === 'contenido' ? 'en-US' : 'es-ES';
        speakText(text, parseFloat(e.target.value), lang);
      }
    });
  });
});

</script>

<!-- Modal para ampliar imagen -->
<div id="imageModal" class="image-modal">
  <div class="modal-content">
    <img id="modalImage" src="" alt="Imagen ampliada">
    <button class="close-modal" id="closeModal">&times;</button>
  </div>
</div>

<script>
// Funciones para el modal de imagen
function openImageModal(src, alt) {
  const modal = document.getElementById('imageModal');
  const modalImage = document.getElementById('modalImage');
  
  modalImage.src = src;
  modalImage.alt = alt;
  modal.style.display = 'block';
  document.body.style.overflow = 'hidden'; // Prevenir scroll del body
}

function closeImageModal() {
  const modal = document.getElementById('imageModal');
  modal.style.display = 'none';
  document.body.style.overflow = 'auto'; // Restaurar scroll del body
}

// Event listeners para el modal
document.addEventListener('DOMContentLoaded', function() {
  const modal = document.getElementById('imageModal');
  const closeBtn = document.getElementById('closeModal');
  
  // Cerrar modal con el botón X
  closeBtn.addEventListener('click', closeImageModal);
  
  // Cerrar modal al hacer clic fuera de la imagen
  modal.addEventListener('click', function(e) {
    if (e.target === this) {
      closeImageModal();
    }
  });
  
  // Cerrar modal con tecla Escape
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeImageModal();
    }
  });
});
</script>

</body>
</html>


